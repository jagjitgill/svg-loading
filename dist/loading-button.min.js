function classReg(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function toggleClass(e,t){(hasClass(e,t)?removeClass:addClass)(e,t)}function LoadingButton(e,t){this.el=e,this.options=t,this.init()}function circularLoading(e){var t=document.querySelector(e),i=new LoadingButton(t,{svg:"#circular-loading",paths:[{selector:".outer-path",animation:function(e){var t=this;e.draw("15%","25%",.2,{callback:function(){e.draw("75%","150%",.3,{circular:!0,callback:function(){e.draw("70%","75%",.3,{circular:!0,callback:function(){e.draw("100%","100% + 0.1",.4,{circular:!0,callback:function(){t.completed(!0)}})}})}})}})}},{selector:".inner-path",animation:function(e){e.draw("20%","80%",.6,{callback:function(){e.draw("100%","100% + 0.1",.6,{circular:!0})}})}}]});return addClass(t,"circular-loading"),i}function circleLoading(e){function t(e){var n=this;e.draw("-20%","0%"),e.draw("-120%","-100%",1,{circular:!0,callback:function(){n.infinite?(t.call(n,e),i.call(n,n.options.paths[1].segment)):(e.draw("-100%","-100% + 0.1",.7,{circular:!0,callback:function(){removeClass(s,"show-circles"),n.handleResponse()}}),n.options.paths[1].segment.draw("100%","100% + 0.1",.7,{circular:!0}))}})}function i(e){e.draw("30%","50%"),e.draw("130%","150%",1,{circular:!0,callback:function(){}})}var s=document.querySelector(e),n=new LoadingButton(s,{svg:"#circle-loading",paths:[{selector:".outer-path",animation:t},{selector:".inner-path",animation:i}]});s.querySelectorAll("circle");return addClass(s,"circle-loading"),n}function infinityLoading(e){function t(e){var i=this;e.draw("100%","150%",1,{circular:!0,callback:function(){i.infinite?t.call(i,e):e.draw("100%","100% + 0.1",.5,{circular:!0,callback:function(){i.handleResponse()}})}})}var i=document.querySelector(e),s=new LoadingButton(i,{svg:"#infinity-loading",paths:[{selector:".infinity-path",animation:t}]});return addClass(i,"infinity-loading"),s}function initializeLoading(e,t){if(e&&null!=document.querySelector(e)){var i=null,s="right",n=document.querySelector(e);switch("BUTTON"!==n.tagName&&"A"!==n.tagName&&(s="inline"),void 0===t&&(t={}),t={position:t.position||s,type:t.type||"circular",scale:t.scale||null},addClass(n,t.position),t.scale&&"inline"==t.position&&addClass(n,t.scale),t.type.toLowerCase()){case"circular":i=circularLoading(e);break;case"circle":i=circleLoading(e);break;case"infinity":i=infinityLoading(e)}return i}return console.log("Invalid! No cssSelector passed."),"Invalid! No cssSelector passed."}"classList"in document.documentElement?(hasClass=function(e,t){return e.classList.contains(t)},addClass=function(e,t){e.classList.add(t)},removeClass=function(e,t){e.classList.remove(t)}):(hasClass=function(e,t){return classReg(t).test(e.className)},addClass=function(e,t){hasClass(e,t)||(e.className=e.className+" "+t)},removeClass=function(e,t){e.className=e.className.replace(classReg(t)," ")}),LoadingButton.prototype={init:function(){this.infinite=!0,this.succeed=!1,this.initDOM(),this.initSegments(),this.initEvents()},initDOM:function(){this.el.innerHTML="<span>"+this.el.innerHTML+"</span>",this.span=this.el.querySelector("span");var e=document.createElement("div");e.innerHTML=document.querySelector(this.options.svg).innerHTML,this.svg=e.querySelector("svg"),this.el.appendChild(this.svg)},initSegments:function(){for(var e=0,t=this.options.paths,i=t.length;e<i;e++)t[e].el=this.svg.querySelector(t[e].selector),t[e].begin=t[e].begin?t[e].begin:0,t[e].end=t[e].end?t[e].end:.1,t[e].segment=new Segment(t[e].el,t[e].begin,t[e].end);this.success=this.el.querySelector(".success-path"),this.error=this.el.querySelector(".error-path"),this.error2=this.el.querySelector(".error-path2"),this.successSegment=new Segment(this.success,0,.1),this.errorSegment=new Segment(this.error,0,.1),this.errorSegment2=new Segment(this.error2,0,.1)},initEvents:function(){var e=this;addClass(e.el,"loading-element"),"A"==e.el.tagName||"BUTTON"==e.el.tagName?e.el.addEventListener("click",function(){e.el.disabled="disabled",e.startAnimation()},!1):this.startAnimation()},startAnimation:function(){var e=this;this.defaultText=e.span.innerHTML,e.el.getAttribute("data-progress")&&(e.buttonText=e.el.getAttribute("data-progress"),e.span.innerHTML=e.buttonText),addClass(e.el,"open-loading");for(var t=0,i=e.options.paths,s=i.length;t<s;t++)i[t].animation.call(e,i[t].segment)},triggerFail:function(e){this.infinite=!1,this.succeed=!1,e&&(this.text=e)},triggerSilentFail:function(e){this.infinite=!1,this.succeed=!1,this.silent=!0,e&&(this.text=e)},triggerSuccess:function(e){this.infinite=!1,this.succeed=!0,e&&(this.text=e)},triggerSilentSuccess:function(e){this.infinite=!1,this.succeed=!0,this.silent=!0,e&&(this.text=e)},completed:function(e){if(this.infinite)for(var t=0,i=this.options.paths,s=i.length;t<s;t++)e&&i[t].segment.draw(0,.1),i[t].animation.call(this,i[t].segment);else this.handleResponse()},handleResponse:function(){for(var e=0,t=this.options.paths,i=t.length;e<i;e++)t[e].el.style.visibility="hidden";this.silent?this.reset():this.succeed?(this.success.style.visibility="visible",this.successAnimation()):(this.error.style.visibility="visible",this.error2.style.visibility="visible",this.errorAnimation())},successAnimation:function(){var e=this;this.text?e.successText=this.text:e.el.getAttribute("data-success")&&(e.successText=e.el.getAttribute("data-success")),e.successSegment.draw("100% - 50","100%",.4,{callback:function(){void 0!==e.successText&&(e.span.innerHTML=e.successText),addClass(e.el,"succeed"),setTimeout(function(){e.reset()},2e3)}})},errorAnimation:function(){var e=this;this.text?e.errorText=this.text:e.el.getAttribute("data-fail")&&(e.errorText=e.el.getAttribute("data-fail")),e.errorSegment.draw("100% - 42.5","100%",.4),e.errorSegment2.draw("100% - 42.5","100%",.4,{callback:function(){void 0!==e.errorText&&(e.span.innerHTML=e.errorText),addClass(e.el,"failed"),setTimeout(function(){e.reset()},2e3)}})},reset:function(){this.el.removeAttribute("disabled"),removeClass(this.el,"open-loading"),this.defaultText&&(this.resetText=this.defaultText),this.el.getAttribute("data-reset")&&(this.resetText=this.el.getAttribute("data-reset")),void 0!==this.resetText&&(this.span.innerHTML=this.resetText),removeClass(this.el,"succeed"),removeClass(this.el,"failed"),this.resetSegments(),this.infinite=!0;for(var e=0,t=this.options.paths,i=t.length;e<i;e++)t[e].el.style.visibility="visible";this.success.style.visibility="hidden",this.error.style.visibility="hidden",this.error2.style.visibility="hidden"},resetSegments:function(){for(var e=0,t=this.options.paths,i=t.length;e<i;e++)t[e].segment.draw(t[e].begin,t[e].end);this.successSegment.draw(0,.1),this.errorSegment.draw(0,.1),this.errorSegment2.draw(0,.1)}};