function classReg(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function toggleClass(t,e){(hasClass(t,e)?removeClass:addClass)(t,e)}function LoadingButton(t,e){this.el=t,this.options=e,this.init()}function circularLoading(t){var e=document.querySelector(t),i=new LoadingButton(e,{svg:"circular",paths:[{selector:".outer-path",animation:function(t){var e=this;t.draw("15%","25%",.2,{callback:function(){t.draw("75%","150%",.3,{circular:!0,callback:function(){t.draw("70%","75%",.3,{circular:!0,callback:function(){t.draw("100%","100% + 0.1",.4,{circular:!0,callback:function(){e.completed(!0)}})}})}})}})}},{selector:".inner-path",animation:function(t){t.draw("20%","80%",.6,{callback:function(){t.draw("100%","100% + 0.1",.6,{circular:!0})}})}}]});return addClass(e,"circular-loading"),i}function circleLoading(t){function e(t){var a=this;t.draw("-20%","0%"),t.draw("-120%","-100%",1,{circular:!0,callback:function(){a.infinite?(e.call(a,t),i.call(a,a.options.paths[1].segment)):(t.draw("-100%","-100% + 0.1",.7,{circular:!0,callback:function(){removeClass(s,"show-circles"),a.handleResponse()}}),a.options.paths[1].segment.draw("100%","100% + 0.1",.7,{circular:!0}))}})}function i(t){t.draw("30%","50%"),t.draw("130%","150%",1,{circular:!0,callback:function(){}})}var s=document.querySelector(t),a=new LoadingButton(s,{svg:"circle",paths:[{selector:".outer-path",animation:e},{selector:".inner-path",animation:i}]});s.querySelectorAll("circle");return addClass(s,"circle-loading"),a}function infinityLoading(t){function e(t){var i=this;t.draw("100%","150%",1,{circular:!0,callback:function(){i.infinite?e.call(i,t):t.draw("100%","100% + 0.1",.5,{circular:!0,callback:function(){i.handleResponse()}})}})}var i=document.querySelector(t),s=new LoadingButton(i,{svg:"infinity",paths:[{selector:".infinity-path",animation:e}]});return addClass(i,"infinity-loading"),s}function initializeLoading(t,e){if(t&&null!=document.querySelector(t)){var i=null,s="right",a=document.querySelector(t);switch("BUTTON"!==a.tagName&&"A"!==a.tagName&&(s="inline"),void 0===e&&(e={}),e={position:e.position||s,type:e.type||"circular",scale:e.scale||null},addClass(a,e.position),e.scale&&"inline"==e.position&&addClass(a,e.scale),e.type.toLowerCase()){case"circular":i=circularLoading(t);break;case"circle":i=circleLoading(t);break;case"infinity":i=infinityLoading(t)}return i}return console.log("Invalid! No cssSelector passed."),"Invalid! No cssSelector passed."}function getAnimationMarkup(t){var e=t||"circular",i=[];return i.circular='<svg width="120px" height="120px"> <path class="outer-path color" d="M 60 60 m 0 -50 a 50 50 0 1 1 0 100 a 50 50 0 1 1 0 -100"></path> <path class="inner-path color2" d="M 60 60 m 0 -30 a 30 30 0 1 1 0 60 a 30 30 0 1 1 0 -60"></path> <path class="success-path color" d="M 60 10 A 50 50 0 0 1 91 21 L 75 45 L 55 75 L 45 65"></path> <path class="error-path color" d="M 60 10 A 50 50 0 0 1 95 25 L 45 75"></path> <path class="error-path2 color" d="M 60 30 A 30 30 0 0 1 81 81 L 45 45"></path> </svg>',i.circle='<svg width="120px" height="120px"> <circle r="50" cx="60" cy="60" fill="none" class="color2"></circle> <circle r="30" cx="60" cy="60" fill="none" class="color2"></circle> <path class="outer-path color" d="M 60 60 m 0 -50 a 50 50 0 1 1 0 100 a 50 50 0 1 1 0 -100"></path> <path class="inner-path color" d="M 60 60 m 0 -30 a 30 30 0 1 1 0 60 a 30 30 0 1 1 0 -60"></path> <path class="success-path color" d="M 60 10 A 50 50 0 0 0 16 36  L 45 65 L 55 75 L 75 45"></path> <path class="error-path color" d="M 60 10 A 50 50 0 0 0 25 95 L 75 45"></path> <path class="error-path2 color" d="M 60 30 A 30 30 0 0 1 81 81 L 45 45"></path> </svg>',i.infinity='<svg width="120px" height="60px"><path class="infinity-path color" d="M 30 10 a 20 20 0 1 0 0 40 c 20 0 40 -40 60 -40 a 20 20 0 0 1 0 40 c -20 0 -40 -40 -60 -40"></path><path class="success-path color" d="M 30 10 C 15 10 35 25 45 35 L 55 45 L 75 15"></path><path class="error-path color" d="M 30 10 a 20 20 0 1 0 0 40 Q 40 50 45 45 L 75 15"></path><path class="error-path2 color" d="M 30 10 Q 40 10 45 15 L 75 45"></path></svg>',i[e]?i[e]:i.circular}"classList"in document.documentElement?(hasClass=function(t,e){return t.classList.contains(e)},addClass=function(t,e){t.classList.add(e)},removeClass=function(t,e){t.classList.remove(e)}):(hasClass=function(t,e){return classReg(e).test(t.className)},addClass=function(t,e){hasClass(t,e)||(t.className=t.className+" "+e)},removeClass=function(t,e){t.className=t.className.replace(classReg(e)," ")}),LoadingButton.prototype={init:function(){this.infinite=!0,this.succeed=!1,this.lstate="default",this.initDOM(),this.initSegments(),this.initEvents()},initDOM:function(){this.el.innerHTML="<span>"+this.el.innerHTML+"</span>",this.span=this.el.querySelector("span");var t=document.createElement("div");t.innerHTML=getAnimationMarkup(this.options.svg),this.svg=t.querySelector("svg"),this.el.appendChild(this.svg)},initSegments:function(){for(var t=0,e=this.options.paths,i=e.length;t<i;t++)e[t].el=this.svg.querySelector(e[t].selector),e[t].begin=e[t].begin?e[t].begin:0,e[t].end=e[t].end?e[t].end:.1,e[t].segment=new Segment(e[t].el,e[t].begin,e[t].end);this.success=this.el.querySelector(".success-path"),this.error=this.el.querySelector(".error-path"),this.error2=this.el.querySelector(".error-path2"),this.successSegment=new Segment(this.success,0,.1),this.errorSegment=new Segment(this.error,0,.1),this.errorSegment2=new Segment(this.error2,0,.1)},initEvents:function(){var t=this;addClass(t.el,"loading-element"),"A"==t.el.tagName||"BUTTON"==t.el.tagName?t.el.addEventListener("click",function(){t.el.disabled="disabled",t.startAnimation()},!1):this.startAnimation()},startAnimation:function(){var t=this;this.lstate="loading",this.defaultText=t.span.innerHTML,t.el.getAttribute("data-progress")&&(t.buttonText=t.el.getAttribute("data-progress"),t.span.innerHTML=t.buttonText),addClass(t.el,"open-loading");for(var e=0,i=t.options.paths,s=i.length;e<s;e++)i[e].animation.call(t,i[e].segment)},triggerFail:function(t){this.infinite=!1,this.succeed=!1,t&&(this.text=t)},triggerSilentFail:function(t){this.infinite=!1,this.succeed=!1,this.silent=!0,t&&(this.text=t)},triggerSuccess:function(t){this.infinite=!1,this.succeed=!0,t&&(this.text=t)},triggerSilentSuccess:function(t){this.infinite=!1,this.succeed=!0,this.silent=!0,t&&(this.text=t)},completed:function(t){if(this.infinite)for(var e=0,i=this.options.paths,s=i.length;e<s;e++)t&&i[e].segment.draw(0,.1),i[e].animation.call(this,i[e].segment);else this.handleResponse()},handleResponse:function(){for(var t=0,e=this.options.paths,i=e.length;t<i;t++)e[t].el.style.visibility="hidden";this.silent?this.reset():this.succeed?(this.success.style.visibility="visible",this.successAnimation()):(this.error.style.visibility="visible",this.error2.style.visibility="visible",this.errorAnimation())},successAnimation:function(){var t=this;this.text?t.successText=this.text:t.el.getAttribute("data-success")&&(t.successText=t.el.getAttribute("data-success")),t.successSegment.draw("100% - 50","100%",.4,{callback:function(){t.lstate="success",void 0!==t.successText&&(t.span.innerHTML=t.successText),addClass(t.el,"succeed"),setTimeout(function(){t.reset()},2e3)}})},errorAnimation:function(){var t=this;this.text?t.errorText=this.text:t.el.getAttribute("data-fail")&&(t.errorText=t.el.getAttribute("data-fail")),t.errorSegment.draw("100% - 42.5","100%",.4),t.errorSegment2.draw("100% - 42.5","100%",.4,{callback:function(){t.lstate="failed",void 0!==t.errorText&&(t.span.innerHTML=t.errorText),addClass(t.el,"failed"),setTimeout(function(){t.reset()},2e3)}})},reset:function(){this.el.removeAttribute("disabled"),removeClass(this.el,"open-loading"),this.lstate="default",this.defaultText&&(this.resetText=this.defaultText),this.el.getAttribute("data-reset")&&(this.resetText=this.el.getAttribute("data-reset")),void 0!==this.resetText&&(this.span.innerHTML=this.resetText),removeClass(this.el,"succeed"),removeClass(this.el,"failed"),this.resetSegments(),this.infinite=!0;for(var t=0,e=this.options.paths,i=e.length;t<i;t++)e[t].el.style.visibility="visible";this.success.style.visibility="hidden",this.error.style.visibility="hidden",this.error2.style.visibility="hidden"},resetSegments:function(){for(var t=0,e=this.options.paths,i=e.length;t<i;t++)e[t].segment.draw(e[t].begin,e[t].end);this.successSegment.draw(0,.1),this.errorSegment.draw(0,.1),this.errorSegment2.draw(0,.1)}};